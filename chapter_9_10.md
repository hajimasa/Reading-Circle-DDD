# 9-10章

## ファクトリ

## メモ
複雑なオブイェクトの生成処理をオブジェクトとして定義する。
この生成を責務とするオブジェクトのことをファクトリという。

インスタンスを生成したいときには適当なIDを振り、さもなければデータベース接続して、採番を行えるようにしたいところです。

ゲッターは公開せずに、メソッドでインスタンスを生成して戻り値として返却する

コンストラ他のオブジェクトを生成するかどうか、はファクトリを作る指標になる。

## 質問

Q. ファクトリを使用すると、基本的にはインスタンス生成時に、ファクトリを通るようになる？

Q. ファクトリの存在を気づかせるためのパッケージに依るグループ分けがわからない

Q
ここらへんがわからん
エンティティは識別子により識別されるオブジェクトです。その識別子が永続化を行うまで存在しないというのは不自然で強烈な制限事項です。誤って識別子が設定されないうちに操作してしまったら、意図しない挙動になるでしょう。開発者は永続化されるまで識別子が生成されないことを常に意識し、細心の注意を払う他ありません。

Q. RDBの自動採番機能を使うのであれば、しっかりとルールを周知させる必要がある。ってことは自動採番機能はなるべく採用しないほうが良いということ？


# 整合性

ヘッダとボディが常に互いが存在する一貫性
同時に登録処理を行ってしまうことで、同じユーザー名でユーザーが作られてしまうことがある。

ユニークキー制約による防御
ユニークキー制約によって整合性を保っても、コードからルールを読み取るのは難解

なるべくトランザクションを使おう！

ユニットオブワーク

phpにはAOPが無いらしいじゃないか！

Q. phpでトランザクションは使えるのか？
PDOによるトランザクション？
https://www.php.net/manual/ja/pdo.transactions.php

